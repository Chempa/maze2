window.__require=function t(i,o,e){function a(s,n){if(!o[s]){if(!i[s]){var c=s.split("/");if(c=c[c.length-1],!i[c]){var h="function"==typeof __require&&__require;if(!n&&h)return h(c,!0);if(r)return r(c,!0);throw new Error("Cannot find module '"+s+"'")}s=c}var d=o[s]={exports:{}};i[s][0].call(d.exports,function(t){return a(i[s][1][t]||t)},d,d.exports,t,i,o,e)}return o[s].exports}for(var r="function"==typeof __require&&__require,s=0;s<e.length;s++)a(e[s]);return a}({arrow:[function(t,i,o){"use strict";cc._RF.push(i,"46bd49/pWRDKI8AqziJbZas","arrow"),cc.Class({extends:cc.Component,properties:{actionDistance:20,actionDuration:0},setArrowAction:function(){var t=cc.moveTo(this.actionDuration,cc.v2(0,this.actionDistance)),i=cc.moveTo(this.actionDuration,cc.v2(0,-this.actionDistance));return cc.repeatForever(cc.sequence(t,i))},onLoad:function(){this.arrowAction=this.setArrowAction(),this.node.runAction(this.arrowAction)},start:function(){}}),cc._RF.pop()},{}],background:[function(t,i,o){"use strict";cc._RF.push(i,"e3041WGnv9B1pcsnCAED7vC","background"),cc.Class({extends:cc.Component,properties:{Joint:{default:null,type:cc.Prefab},boardPerRow:0,boardHeight:0},onLoad:function(){},refresh:function(){this.node.width=this.boardPerRow*this.boardHeight+20,this.node.height=this.boardPerRow*this.boardHeight+20,this.node.x=this.node.width/2-this.boardHeight/2-10,this.node.y=this.node.height/2-this.boardHeight/2-10,console.log(this.boardPerRow),console.log(this.boardHeight);for(var t=0;t<=this.boardPerRow;t++)for(var i=0;i<=this.boardPerRow;i++){var o=cc.instantiate(this.Joint);this.node.addChild(o),o.x=i*this.boardHeight-this.node.width/2+10,o.y=t*this.boardHeight-this.node.width/2+10}},start:function(){},update:function(t){}}),cc._RF.pop()},{}],board:[function(t,i,o){"use strict";cc._RF.push(i,"09e35rABRhAcbyUPvGSe+fM","board"),cc.Class({extends:cc.Component,properties:{cmd:-1,left:{default:null,type:cc.Node},right:{default:null,type:cc.Node},down:{default:null,type:cc.Node},up:{default:null,type:cc.Node},noWall:0,Wall:255},onLoad:function(){-1!=this.cmd&&(8&this.cmd?(this.up.opacity=this.Wall,this.up.zIndex=cc.macro.MAX_ZINDEX):this.up.opacity=this.noWall,4&this.cmd?(this.right.opacity=this.Wall,this.right.zIndex=cc.macro.MAX_ZINDEX):this.right.opacity=this.noWall,2&this.cmd?(this.down.opacity=this.Wall,this.down.zIndex=cc.macro.MAX_ZINDEX):this.down.opacity=this.noWall,1&this.cmd?(this.left.opacity=this.Wall,this.left.zIndex=cc.macro.MAX_ZINDEX):this.left.opacity=this.noWall)},start:function(){}}),cc._RF.pop()},{}],game:[function(t,i,o){"use strict";cc._RF.push(i,"63a3cN2So9JFpBDLcl5BJ89","game"),cc.Class({extends:cc.Component,properties:{},onLoad:function(){},start:function(){}}),cc._RF.pop()},{}],player:[function(t,i,o){"use strict";cc._RF.push(i,"02bdbcSX31KfLn/OKJ7/Mo4","player"),cc.Class({extends:cc.Component,properties:{PlayerRotar:{default:null,type:cc.Node},Star:{default:null,type:cc.Prefab},Background:{default:null,type:cc.Node},Camera:{default:null,type:cc.Node},Board:{default:null,type:cc.Prefab},gridData:{default:null,visible:!1},JsonData:{default:null,type:cc.JsonAsset},up:!1,down:!1,right:!1,left:!1,rotateDuration:.1,moveDuration:.2,boardHeight:150,gridPosPlayer_X:0,gridPosPlayer_Y:0,boardPerRow:0,noWall:0,Wall:255,Rules:{default:null,visible:!1},Relations:{default:null,visible:!1}},onKeyDown:function(t){switch(t.keyCode){case cc.macro.KEY.right:this.right=!0;break;case cc.macro.KEY.left:this.left=!0;break;case cc.macro.KEY.up:this.up=!0;break;case cc.macro.KEY.down:this.down=!0}},onKeyUp:function(t){switch(t.keyCode){case cc.macro.KEY.right:this.right=!1;break;case cc.macro.KEY.left:this.left=!1;break;case cc.macro.KEY.up:this.up=!1;break;case cc.macro.KEY.down:this.down=!1}},toDegree:function(t){return t*(180/Math.PI)},calcAngle:function(){var t=this.gridPosPlayer_X,i=this.gridPosPlayer_Y,o=this.gridPosStar_X,e=this.gridPosStar_Y;if(t==o)return i>e?180:0;if(i==e)return t>o?270:90;if(o<t&&e<i){console.log("State 1");var a=Math.abs(t-o),r=Math.abs(i-e);return 180+this.toDegree(Math.atan(a/r))}if(o>t&&e<i){console.log("State 2");a=Math.abs(i-e),r=Math.abs(t-o);return this.toDegree(Math.atan(a/r))+90}if(o>t&&e>i){console.log("State 3");a=Math.abs(t-o),r=Math.abs(i-e);return this.toDegree(Math.atan(a/r))}if(o<t&&e>i){console.log("State 4");a=Math.abs(i-e),r=Math.abs(t-o);return 270+this.toDegree(Math.atan(a/r))}return null},isValidMove:function(t){var i=this.gridPosPlayer_X,o=this.gridPosPlayer_Y,e=String(i)+","+String(o),a=this.gridData[e];return"u"==t?!(o-1<0)&&a.getChildByName("up").opacity==this.noWall:"d"==t?!(o+1>this.boardPerRow-1)&&a.getChildByName("down").opacity==this.noWall:"r"==t?!(i+1>this.boardPerRow-1)&&a.getChildByName("right").opacity==this.noWall:"l"==t&&(!(i-1<0)&&a.getChildByName("left").opacity==this.noWall)},pointToStar:function(){var t=this.calcAngle(),i=cc.rotateTo(this.rotateDuration,t);this.PlayerRotar.runAction(i)},createStar:function(t,i){var o=cc.instantiate(this.Star);this.node.parent.addChild(o),o.x=t*this.boardHeight,o.y=i*this.boardHeight},updateGrid:function(){for(var t=this.gridPosPlayer_X,i=this.gridPosPlayer_Y,o=[],e=0;e<this.Relations[i][t].length;e++){var a=this.Relations[i][t][e][0],r=this.Relations[i][t][e][1],s=String(r)+","+String(a);o[s]=1,s in this.gridData||this.createBoard(r,a,this.Rules[a][r])}for(var n in this.gridData)n in o||(this.gridData[n].destroy(),delete this.gridData[n])},createBoard:function(t,i,o){var e=String(t)+","+String(i);this.gridData[e]=cc.instantiate(this.Board),this.gridData[e].getComponent("board").cmd=o,this.node.parent.addChild(this.gridData[e]),this.gridData[e].x=t*this.boardHeight,this.gridData[e].y=i*this.boardHeight},movePlayer:function(){var t=this.node.x,i=this.node.y;if(0==this.node.getNumberOfRunningActions()){if(this.down&&this.isValidMove("d")){var o=cc.moveTo(this.moveDuration,cc.v2(t,i+this.boardHeight)),e=cc.moveTo(this.moveDuration,cc.v2(t,i+this.boardHeight));return this.node.runAction(e),this.Camera.runAction(o),this.gridPosPlayer_Y+=1,this.updateGrid(),void this.pointToStar()}if(this.up&&this.isValidMove("u")){o=cc.moveTo(this.moveDuration,cc.v2(t,i-this.boardHeight)),e=cc.moveTo(this.moveDuration,cc.v2(t,i-this.boardHeight));return this.node.runAction(e),this.Camera.runAction(o),this.gridPosPlayer_Y-=1,this.updateGrid(),void this.pointToStar()}if(this.left&&this.isValidMove("l")){o=cc.moveTo(this.moveDuration,cc.v2(t-this.boardHeight,i)),e=cc.moveTo(this.moveDuration,cc.v2(t-this.boardHeight,i));return this.node.runAction(e),this.Camera.runAction(o),this.gridPosPlayer_X-=1,this.updateGrid(),void this.pointToStar()}if(this.right&&this.isValidMove("r")){o=cc.moveTo(this.moveDuration,cc.v2(t+this.boardHeight,i)),e=cc.moveTo(this.moveDuration,cc.v2(t+this.boardHeight,i));return this.node.runAction(e),this.Camera.runAction(o),this.gridPosPlayer_X+=1,this.updateGrid(),void this.pointToStar()}}},onLoad:function(){var t=this.JsonData.json;this.Rules=t[0],this.Relations=t[1],this.gridData={},this.boardPerRow=this.Rules.length,this.updateGrid(),this.gridPosStar_X=this.Rules.length-1,this.gridPosStar_Y=this.Rules.length-1,this.createStar(this.gridPosStar_X,this.gridPosStar_Y),this.Background.getComponent("background").boardPerRow=this.boardPerRow,this.Background.getComponent("background").boardHeight=this.boardHeight,this.Background.getComponent("background").refresh(),this.node.x=this.gridPosPlayer_X*this.boardHeight,this.node.y=this.gridPosPlayer_Y*this.boardHeight,this.Camera.x=this.node.x,this.Camera.y=this.node.y,this.pointToStar(-1),cc.systemEvent.on(cc.SystemEvent.EventType.KEY_DOWN,this.onKeyDown,this),cc.systemEvent.on(cc.SystemEvent.EventType.KEY_UP,this.onKeyUp,this)},start:function(){},update:function(t){this.movePlayer()}}),cc._RF.pop()},{}],star:[function(t,i,o){"use strict";cc._RF.push(i,"bfb8di7C9ZCnbKfbXNIYeqM","star"),cc.Class({extends:cc.Component,properties:{gridPosStar_X:0,gridPosStar_Y:0,boardHeight:150},onLoad:function(){var t=cc.rotateBy(2,360),i=cc.repeatForever(t);this.node.runAction(i),this.node.x=this.gridPosStar_X*this.boardHeight,this.node.y=this.gridPosStar_Y*this.boardHeight},start:function(){}}),cc._RF.pop()},{}],touchinput:[function(t,i,o){"use strict";cc._RF.push(i,"d5f236pxZRGSawKw5vO+AIC","touchinput"),cc.Class({extends:cc.Component,properties:{Player:{default:null,type:cc.Node},previousDirection:0,touchEventCount:0,up:!1,down:!1,right:!1,left:!1},stopPlayer:function(){var t=this.Player.getComponent("player");t.down=!1,t.left=!1,t.right=!1,t.up=!1},onLoad:function(){cc.macro.ENABLE_MULTI_TOUCH=!1;var t=this.Player.getComponent("player");this.node.on("touchstart",function(t){console.log("touchstart"),t.stopPropagation()},this),this.node.on("touchend",function(t){console.log("touchend"),this.stopPlayer(),t.stopPropagation()},this),this.node.on("touchcancel",function(t){console.log("touchcancel"),this.stopPlayer(),this.node.resumeSystemEvents(),t.stopPropagation()},this),this.node.on("touchmove",function(i){i.stopPropagation(),console.log("touchmove");var o=i.getLocation().y-i.getStartLocation().y,e=i.getLocation().x-i.getStartLocation().x;Math.abs(o)<50&&Math.abs(e)<10||(Math.abs(o)>Math.abs(e)?o<0?(1!=t.down&&this.stopPlayer(),t.down=!0):(1!=t.up&&this.stopPlayer(),t.up=!0):e<0?(1!=t.left&&this.stopPlayer(),t.left=!0):(1!=t.right&&this.stopPlayer(),t.right=!0))},this)},start:function(){}}),cc._RF.pop()},{}]},{},["background","board","game","arrow","player","star","touchinput"]);